# 🅿️ 實機測試指南

## 1. 事前準備

### 硬體需求
- Android 手機（支援 ARCore，[查詢清單](https://developers.google.com/ar/devices)）
- Android 7.0 以上
- 手機有加速計、陀螺儀、磁力計（現代手機基本都有）

### 安裝 APP

**方式 A：Android Studio 直接安裝**
1. 用 Android Studio 開啟專案根目錄
2. 等 Gradle sync 完成
3. USB 連接手機（開啟開發者模式 + USB 偵錯）
4. 點 ▶️ Run

**方式 B：安裝 APK**
1. Android Studio → Build → Build Bundle(s)/APK(s) → Build APK(s)
2. APK 位於 `app/build/outputs/apk/debug/app-debug.apk`
3. 傳到手機安裝（需允許「不明來源」）

### 首次啟動
- APP 會要求**相機權限**（ARCore 需要）→ 允許
- 如果手機沒裝 ARCore，會提示去 Play Store 安裝

---

## 2. 測試場景

### 測試地點
選一個**地下停車場**，越深層越好（確保沒 GPS 訊號）

### 測試路線建議
```
車位 ─→ 走道 ─→ 轉彎 ─→ 電梯口
 A                              B
```
- 選一條你平常走的路線
- 最好有直線 + 轉彎（測方向偵測）
- 全程約 50-200 公尺即可

---

## 3. 測試步驟

### Test 1: 感測器驗證（10 分鐘）

**目的**：確認所有感測器正常運作

1. 打開 APP，展開感測器面板
2. 確認以下數值在跳動：
   - ✅ 加速計 XYZ（靜止時 Z ≈ 9.8）
   - ✅ 陀螺儀 XYZ（靜止時 ≈ 0）
   - ✅ 磁力計 XYZ（有數值）
   - ✅ ARCore 狀態顯示 TRACKING
3. 手機靜放桌上 30 秒，步數應為 0
4. 拿著手機走 10 步，確認步數大約正確

**記錄**：截圖感測器面板

### Test 2: 軌跡精度（15 分鐘）

**目的**：測量定位漂移程度

1. 站在固定點 A（標記車位）
2. 點「開始記錄」
3. 沿路線走到點 B（電梯口）
4. 原路走回點 A
5. 點「停止記錄」

**觀察重點**：
- 2D 軌跡圖上，去程和回程的路線是否重疊？
- 回到起點時，地圖上的位置是否也回到起點？（閉合誤差）
- ARCore 有沒有失去追蹤？（光線不足的區域）

**記錄**：截圖軌跡圖

### Test 3: 停車找車流程（10 分鐘）

**目的**：模擬真實使用情境

1. 在「車位」按「標記車位」
2. 按「開始記錄」
3. 正常走到電梯口（模擬去逛街）
4. 按「停止記錄」
5. 按「導航回車」
6. 跟著導航箭頭走回車位

**觀察重點**：
- 導航箭頭方向是否正確？
- 能否順利走回標記的車位？
- 剩餘距離顯示是否合理？

**記錄**：截圖導航畫面 + 最終位置

### Test 4: 極端環境（10 分鐘）

**目的**：測試邊界條件

- [ ] 光線極暗的區域（ARCore 是否失效）
- [ ] 快速走路 vs 慢速走路
- [ ] 手機放口袋 vs 拿在手上
- [ ] 上下樓梯或坡道

---

## 4. 數據匯出與回傳

### 匯出步驟
1. 測試完成後，點「匯出數據」
2. APP 會產生 CSV 檔案，可透過分享功能傳送

### CSV 欄位說明
| 欄位 | 說明 |
|------|------|
| timestamp | 時間戳記 (ms) |
| accX/Y/Z | 加速計數值 (m/s²) |
| gyroX/Y/Z | 陀螺儀數值 (rad/s) |
| magX/Y/Z | 磁力計數值 (μT) |
| posX/Y/Z | 估算位置 (m) |
| heading | 方向角 (rad) |
| stepCount | 累計步數 |
| source | 資料來源 (arcore/pdr/fused) |

### 回傳方式
- CSV 檔傳到 Discord #inroom-navigation 頻道
- 附上測試環境描述（停車場名稱、樓層、大約距離）
- 附上截圖

---

## 5. 已知限制

| 限制 | 說明 | 未來改善 |
|------|------|----------|
| ARCore 漂移 | 長距離會累積誤差 | Phase 3 磁場校正 |
| 暗處失效 | ARCore 靠視覺特徵，太暗會丟失 | PDR 備援自動切換 |
| 步長因人而異 | Weinberg 常數 K=0.5 是預設值 | 校準功能 |
| 僅限單層 | 目前不支援多樓層 | 氣壓計樓層偵測 |

---

## 6. 問題回報

測試中遇到問題，請記錄：
1. **什麼情況**下發生
2. **螢幕截圖**或錄影
3. APP 是否**閃退**（如果是，描述最後的操作）

回報到 Discord #inroom-navigation 或開 [GitHub Issue](https://github.com/ench0812/parknav/issues)。
