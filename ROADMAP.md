# 🗺️ ParkNav 開發路線圖

*最後更新: 2026-02-07*

## 開發原則

> 「慢慢來不是停住，是先規劃再動手。」
> 需求想清楚 → 設計確認 → 才寫程式。避免花更多時間在試錯上。

---

## Phase 1: 感測器驗證 ✅ 已完成

**目標**：確認各感測器在地下停車場的數據品質

- [x] ARCore VIO 追蹤
- [x] IMU 感測器讀取（加速計、陀螺儀、磁力計）
- [x] PDR 步伐偵測（Weinberg 模型）
- [x] 2D 軌跡即時顯示
- [x] 停車標記 + 路徑回溯導航
- [x] CSV 數據匯出
- [x] Unit Test × 25
- [x] 測試文件 + 實測指南
- [ ] 模擬器對抗驗證 ← 進行中

**待驗證**：帶實機到停車場跑一輪，收集數據

---

## Phase 1.5: 模擬對抗 ← 目前階段

**目標**：用模擬數據找出演算法問題，在上機前先修

- [ ] PathSimulator — 模擬已知路徑的感測器數據
- [ ] PathValidator — 餵入引擎，比對誤差
- [ ] 模擬路線：直線、L 型、矩形迴圈、靜止
- [ ] 根據模擬結果調整演算法參數

**完成標準**：矩形迴圈閉合誤差 < 10%

---

## Phase 2: 實測迭代（等 Phase 1.5 通過後）

**目標**：根據實機數據調整演算法

### 設計階段（先做）
- [ ] 定義精度指標：什麼算「夠好」？（閉合誤差 < 3m？）
- [ ] 定義測試 protocol：標準化測試流程
- [ ] 分析 Phase 1 收集的 CSV 數據
- [ ] 識別主要誤差來源（VIO 漂移？步長不準？方向偏？）

### 實作階段（想清楚再做）
- [ ] 根據分析結果決定優化方向
- [ ] Weinberg K 值校準工具
- [ ] ARCore 失效時自動切換 PDR
- [ ] 多樓層支援（氣壓計）

---

## Phase 3: 磁場校正（等 Phase 2 穩定後）

**目標**：用磁場指紋修正累計漂移

### 設計階段（先做）
- [ ] 研究停車場磁場特徵分佈
- [ ] 設計磁場採集工具 UX
- [ ] 選擇匹配演算法（ICCP? DTW?）
- [ ] 定義校正精度目標

### 實作階段（想清楚再做）
- [ ] 磁場數據採集模式
- [ ] 磁場地圖儲存格式
- [ ] 即時磁場比對校正
- [ ] Kalman Filter 多源融合

---

## 排程

| 時間 | 里程碑 |
|------|--------|
| 2/7 (六) | Phase 1 完成 ✅ |
| 2/8 (日) | 模擬器完成 + 根據結果調參 |
| 2/10 (一) | 茂帶手機實測 Phase 1 |
| 2/10 後 | 分析實測數據 → 規劃 Phase 2 |

---

## 決策紀錄

| 日期 | 決策 | 原因 |
|------|------|------|
| 2/7 | 用 Kotlin + Compose | 現代 Android 標準 |
| 2/7 | ARCore VIO 為主定位 | 精度最高，不需硬體 |
| 2/7 | Weinberg 步長模型 | 學術驗證充分，實作簡單 |
| 2/7 | 互補濾波器 (α=0.98) | 比純磁力計穩定 |
| 2/7 | 加入模擬對抗 | 在實測前先用軟體找 bug |
